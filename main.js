// ==================== Translations ====================
const translations = {
  ko: {
    appTitle: 'ÎûúÎç§ ÌîΩ',
    navLottery: 'Î°úÎòê',
    navDinner: 'Ï†ÄÎÖÅÎ©îÎâ¥',
    navAnimal: 'ÎèôÎ¨ºÏÉÅ',
    lotteryHeading: 'Î°úÎòê Î≤àÌò∏ ÏÉùÏÑ±Í∏∞',
    lotto645Info: '6Í∞ú Î≤àÌò∏ (1-45)',
    megaInfo: '5Í∞ú Î≤àÌò∏ (1-70) + Î©îÍ∞ÄÎ≥º (1-25)',
    powerballInfo: '5Í∞ú Î≤àÌò∏ (1-69) + ÌååÏõåÎ≥º (1-26)',
    generate: 'Î≤àÌò∏ ÏÉùÏÑ±',
    generateAll: 'Ï†ÑÏ≤¥ ÏÉùÏÑ±',
    dinnerHeading: 'Ï†ÄÎÖÅ Î©îÎâ¥ Ï∂îÏ≤ú',
    dinnerPlaceholder: 'Î©îÎâ¥Î•º ÎΩëÏïÑÎ≥¥ÏÑ∏Ïöî!',
    categoryTitle: 'Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù',
    catAll: 'Ï†ÑÏ≤¥',
    catKorean: 'ÌïúÏãù',
    catChinese: 'Ï§ëÏãù',
    catJapanese: 'ÏùºÏãù',
    catWestern: 'ÏñëÏãù',
    catAsian: 'ÏïÑÏãúÏïà',
    pickDinner: 'ÎûúÎç§ Î©îÎâ¥ ÎΩëÍ∏∞',
    historyTitle: 'ÏµúÍ∑º Í∏∞Î°ù',
    historyEmpty: 'ÏïÑÏßÅ Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§',
    clearHistory: 'Í∏∞Î°ù ÏßÄÏö∞Í∏∞',
    contactTitle: 'Ï†úÌú¥ Î¨∏Ïùò',
    formName: 'Ïù¥Î¶Ñ',
    formNamePlaceholder: 'Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî',
    formEmail: 'Ïù¥Î©îÏùº',
    formEmailPlaceholder: 'Ïù¥Î©îÏùºÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî',
    formCompany: 'ÌöåÏÇ¨Î™Ö',
    formCompanyPlaceholder: 'ÌöåÏÇ¨Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî',
    formMessage: 'Î¨∏Ïùò ÎÇ¥Ïö©',
    formMessagePlaceholder: 'Î¨∏Ïùò ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî',
    formSubmit: 'Î¨∏ÏùòÌïòÍ∏∞',
    formNotice: 'ÏòÅÏóÖÏùº Í∏∞Ï§Ä 2-3Ïùº ÎÇ¥ ÌöåÏã†ÎìúÎ¶ΩÎãàÎã§.',
    commentsTitle: 'ÎåìÍ∏Ä',
    animalHeading: 'ÎèôÎ¨ºÏÉÅ ÌÖåÏä§Ìä∏',
    animalPlaceholder: 'ÏÇ¨ÏßÑÏùÑ ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî!',
    uploadTitle: 'ÏÇ¨ÏßÑ ÏóÖÎ°úÎìú',
    uploadText: 'ÌÅ¥Î¶≠ÌïòÏó¨ Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú',
    analyzeBtn: 'ÎÇ¥ ÏñºÍµ¥ Î∂ÑÏÑùÌïòÍ∏∞',
    analyzing: 'Î∂ÑÏÑù Ï§ë...',
    howItWorks: 'Ïù¥Ïö© Î∞©Î≤ï',
    animalDescription: 'AIÍ∞Ä ÎãπÏã†Ïùò ÏÇ¨ÏßÑÏùÑ Î∂ÑÏÑùÌïòÏó¨ Í∞ïÏïÑÏßÄÏÉÅÏù∏ÏßÄ Í≥†ÏñëÏù¥ÏÉÅÏù∏ÏßÄ ÌåêÎ≥ÑÌï©ÎãàÎã§. Ï†ïÌôïÌïú Í≤∞Í≥ºÎ•º ÏúÑÌï¥ ÏñºÍµ¥Ïù¥ Ïûò Î≥¥Ïù¥Îäî ÏÇ¨ÏßÑÏùÑ ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî!',
    dogFace: 'Í∞ïÏïÑÏßÄÏÉÅ',
    catFace: 'Í≥†ÏñëÏù¥ÏÉÅ',
    dogLabel: 'Í∞ïÏïÑÏßÄ',
    catLabel: 'Í≥†ÏñëÏù¥'
  },
  en: {
    appTitle: 'Random Pick',
    navLottery: 'Lottery',
    navDinner: 'Dinner',
    navAnimal: 'Animal',
    lotteryHeading: 'Lottery Number Generator',
    lotto645Info: '6 numbers (1-45)',
    megaInfo: '5 numbers (1-70) + Mega Ball (1-25)',
    powerballInfo: '5 numbers (1-69) + Powerball (1-26)',
    generate: 'Generate Numbers',
    generateAll: 'Generate All',
    dinnerHeading: 'Dinner Menu Picker',
    dinnerPlaceholder: 'Pick your dinner!',
    categoryTitle: 'Select Category',
    catAll: 'All',
    catKorean: 'Korean',
    catChinese: 'Chinese',
    catJapanese: 'Japanese',
    catWestern: 'Western',
    catAsian: 'Asian',
    pickDinner: 'Pick Random Menu',
    historyTitle: 'Recent Picks',
    historyEmpty: 'No picks yet',
    clearHistory: 'Clear History',
    contactTitle: 'Partnership Inquiry',
    formName: 'Name',
    formNamePlaceholder: 'Enter your name',
    formEmail: 'Email',
    formEmailPlaceholder: 'Enter your email',
    formCompany: 'Company',
    formCompanyPlaceholder: 'Enter your company name',
    formMessage: 'Message',
    formMessagePlaceholder: 'Enter your message',
    formSubmit: 'Send Inquiry',
    formNotice: "We'll get back to you within 2-3 business days.",
    commentsTitle: 'Comments',
    animalHeading: 'Animal Face Test',
    animalPlaceholder: 'Upload your photo!',
    uploadTitle: 'Upload Photo',
    uploadText: 'Click to upload image',
    analyzeBtn: 'Analyze My Face',
    analyzing: 'Analyzing...',
    howItWorks: 'How It Works',
    animalDescription: 'This AI analyzes your photo to determine if you have more dog-like or cat-like features. Upload a clear face photo for best results!',
    dogFace: 'Dog Face',
    catFace: 'Cat Face',
    dogLabel: 'Dog',
    catLabel: 'Cat'
  }
};

// ==================== Dinner Menu Data ====================
const dinnerMenus = {
  korean: [
    { ko: 'ÍπÄÏπòÏ∞åÍ∞ú', en: 'Kimchi Stew' },
    { ko: 'ÎêúÏû•Ï∞åÍ∞ú', en: 'Soybean Paste Stew' },
    { ko: 'ÏÇºÍ≤πÏÇ¥', en: 'Grilled Pork Belly' },
    { ko: 'Î∂àÍ≥†Í∏∞', en: 'Bulgogi' },
    { ko: 'ÎπÑÎπîÎ∞•', en: 'Bibimbap' },
    { ko: 'Í∞àÎπÑÏ∞ú', en: 'Braised Short Ribs' },
    { ko: 'ÏàúÎëêÎ∂ÄÏ∞åÍ∞ú', en: 'Soft Tofu Stew' },
    { ko: 'ÏπºÍµ≠Ïàò', en: 'Knife-cut Noodles' },
    { ko: 'ÏÇºÍ≥ÑÌÉï', en: 'Ginseng Chicken Soup' },
    { ko: 'Ï†úÏú°Î≥∂Ïùå', en: 'Spicy Pork Stir-fry' },
    { ko: 'ÍπÄÎ∞•', en: 'Kimbap' },
    { ko: 'Îñ°Î≥∂Ïù¥', en: 'Tteokbokki' },
    { ko: 'ÎÉâÎ©¥', en: 'Cold Noodles' },
    { ko: 'Í∞êÏûêÌÉï', en: 'Pork Bone Soup' },
    { ko: 'Î∂ÄÎåÄÏ∞åÍ∞ú', en: 'Army Stew' }
  ],
  chinese: [
    { ko: 'ÏßúÏû•Î©¥', en: 'Jajangmyeon' },
    { ko: 'Ïß¨ÎΩï', en: 'Jjamppong' },
    { ko: 'ÌÉïÏàòÏú°', en: 'Sweet and Sour Pork' },
    { ko: 'ÎßàÌååÎëêÎ∂Ä', en: 'Mapo Tofu' },
    { ko: 'ÍπêÌíçÍ∏∞', en: 'Spicy Fried Chicken' },
    { ko: 'ÏñëÏû•Ìîº', en: 'Yangjangpi' },
    { ko: 'Ïú†Î¶∞Í∏∞', en: 'Youlinji' },
    { ko: 'Î≥∂ÏùåÎ∞•', en: 'Fried Rice' },
    { ko: 'Í≥†Ï∂îÏû°Ï±Ñ', en: 'Pepper Japchae' },
    { ko: 'ÌåîÎ≥¥Ï±Ñ', en: 'Eight Treasure Dish' }
  ],
  japanese: [
    { ko: 'Ï¥àÎ∞•', en: 'Sushi' },
    { ko: 'ÎùºÎ©ò', en: 'Ramen' },
    { ko: 'Ïö∞Îèô', en: 'Udon' },
    { ko: 'ÎèàÏπ¥Ï∏†', en: 'Tonkatsu' },
    { ko: 'Ïπ¥Î†àÎùºÏù¥Ïä§', en: 'Curry Rice' },
    { ko: 'Í∑úÎèô', en: 'Gyudon' },
    { ko: 'Ïò§ÏΩîÎÖ∏ÎØ∏ÏïºÎÅº', en: 'Okonomiyaki' },
    { ko: 'ÌÉÄÏΩîÏïºÎÅº', en: 'Takoyaki' },
    { ko: 'ÏÇ¨ÏãúÎØ∏', en: 'Sashimi' },
    { ko: 'Îç¥Ìë∏Îùº', en: 'Tempura' }
  ],
  western: [
    { ko: 'Ïä§ÌÖåÏù¥ÌÅ¨', en: 'Steak' },
    { ko: 'ÌååÏä§ÌÉÄ', en: 'Pasta' },
    { ko: 'ÌîºÏûê', en: 'Pizza' },
    { ko: 'ÌñÑÎ≤ÑÍ±∞', en: 'Hamburger' },
    { ko: 'Î¶¨Ï°∞Îòê', en: 'Risotto' },
    { ko: 'ÏÉêÎü¨Îìú', en: 'Salad' },
    { ko: 'Ïò§ÎØàÎ†õ', en: 'Omelette' },
    { ko: 'ÏπòÌÇ®', en: 'Fried Chicken' },
    { ko: 'ÏÉåÎìúÏúÑÏπò', en: 'Sandwich' },
    { ko: 'ÏàòÌîÑ', en: 'Soup' }
  ],
  asian: [
    { ko: 'ÏåÄÍµ≠Ïàò', en: 'Pho' },
    { ko: 'ÌåüÌÉÄÏù¥', en: 'Pad Thai' },
    { ko: 'Îò†ÏñëÍøç', en: 'Tom Yum Kung' },
    { ko: 'Î∂ÑÏßú', en: 'Bun Cha' },
    { ko: 'Î∞òÎØ∏', en: 'Banh Mi' },
    { ko: 'Ïπ¥Ïò§Ìåü', en: 'Khao Pad' },
    { ko: 'Í∑∏Î¶∞Ïª§Î¶¨', en: 'Green Curry' },
    { ko: 'ÎÇòÏãúÍ≥†Î†ù', en: 'Nasi Goreng' },
    { ko: 'ÎØ∏Í≥†Î†ù', en: 'Mie Goreng' },
    { ko: 'ÏñëÍº¨Ïπò', en: 'Lamb Skewers' }
  ]
};

const categoryIcons = {
  korean: 'üçö',
  chinese: 'ü•ü',
  japanese: 'üç£',
  western: 'üçï',
  asian: 'üçú'
};

let currentLang = 'en';
let currentCategory = 'all';
let dinnerHistory = [];

// ==================== Page Navigation ====================
function showPage(pageName) {
  // Hide all pages
  document.querySelectorAll('.page').forEach(page => {
    page.classList.remove('active');
  });

  // Show selected page
  document.getElementById(pageName + 'Page').classList.add('active');

  // Update nav buttons
  document.querySelectorAll('.nav-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.dataset.page === pageName) {
      btn.classList.add('active');
    }
  });
}

// ==================== Language Functions ====================
function toggleLanguage() {
  currentLang = currentLang === 'en' ? 'ko' : 'en';
  applyLanguage();
  localStorage.setItem('lang', currentLang);
}

function applyLanguage() {
  const elements = document.querySelectorAll('[data-i18n]');
  elements.forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (translations[currentLang][key]) {
      if (el.tagName === 'TITLE') {
        document.title = translations[currentLang][key];
      } else {
        el.textContent = translations[currentLang][key];
      }
    }
  });

  // Translate placeholders
  const placeholderElements = document.querySelectorAll('[data-i18n-placeholder]');
  placeholderElements.forEach(el => {
    const key = el.getAttribute('data-i18n-placeholder');
    if (translations[currentLang][key]) {
      el.placeholder = translations[currentLang][key];
    }
  });

  const langBtn = document.getElementById('langToggle');
  if (langBtn) {
    langBtn.querySelector('.lang-text').textContent = currentLang === 'en' ? 'KO' : 'EN';
  }

  document.documentElement.lang = currentLang;

  // Re-render history with correct language
  renderHistory();
}

function initLanguage() {
  const savedLang = localStorage.getItem('lang');
  if (savedLang) {
    currentLang = savedLang;
  } else {
    const browserLang = navigator.language.slice(0, 2);
    currentLang = browserLang === 'ko' ? 'ko' : 'en';
  }
  applyLanguage();
}

// ==================== Theme Functions ====================
function toggleTheme() {
  const html = document.documentElement;
  const currentTheme = html.getAttribute('data-theme');
  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
  html.setAttribute('data-theme', newTheme);
  localStorage.setItem('theme', newTheme);
}

function initTheme() {
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    document.documentElement.setAttribute('data-theme', savedTheme);
  } else {
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
  }
}

// ==================== Lottery Functions ====================
function getRandomNumbers(count, min, max) {
  const numbers = new Set();
  while (numbers.size < count) {
    const num = Math.floor(Math.random() * (max - min + 1)) + min;
    numbers.add(num);
  }
  return Array.from(numbers).sort((a, b) => a - b);
}

function getRandomNumber(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function updateBalls(containerId, numbers, specialNumber) {
  const container = document.getElementById(containerId);
  const balls = container.querySelectorAll('.ball');

  numbers.forEach((num, index) => {
    const ball = balls[index];
    ball.textContent = num;
    ball.classList.add('animate');
    setTimeout(() => ball.classList.remove('animate'), 300);
  });

  const specialBall = balls[balls.length - 1];
  specialBall.textContent = specialNumber;
  specialBall.classList.add('animate');
  setTimeout(() => specialBall.classList.remove('animate'), 300);
}

function generateMegaMillions() {
  const whiteNumbers = getRandomNumbers(5, 1, 70);
  const megaBall = getRandomNumber(1, 25);
  updateBalls('megaNumbers', whiteNumbers, megaBall);
}

function generatePowerball() {
  const whiteNumbers = getRandomNumbers(5, 1, 69);
  const powerball = getRandomNumber(1, 26);
  updateBalls('powerballNumbers', whiteNumbers, powerball);
}

function generateLotto645() {
  const numbers = getRandomNumbers(6, 1, 45);
  const container = document.getElementById('lotto645Numbers');
  const balls = container.querySelectorAll('.ball');

  numbers.forEach((num, index) => {
    const ball = balls[index];
    ball.textContent = num;
    ball.className = 'ball lotto ' + getLottoColorClass(num);
    ball.classList.add('animate');
    setTimeout(() => ball.classList.remove('animate'), 300);
  });
}

function getLottoColorClass(num) {
  if (num <= 10) return 'lotto-yellow';
  if (num <= 20) return 'lotto-blue';
  if (num <= 30) return 'lotto-red';
  if (num <= 40) return 'lotto-gray';
  return 'lotto-green';
}

function generateAll() {
  generateLotto645();
  generateMegaMillions();
  generatePowerball();
}

// ==================== Dinner Functions ====================
function selectCategory(category) {
  currentCategory = category;

  document.querySelectorAll('.category-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.dataset.category === category) {
      btn.classList.add('active');
    }
  });
}

function getMenusByCategory() {
  if (currentCategory === 'all') {
    return Object.entries(dinnerMenus).flatMap(([cat, menus]) =>
      menus.map(menu => ({ ...menu, category: cat }))
    );
  }
  return dinnerMenus[currentCategory].map(menu => ({ ...menu, category: currentCategory }));
}

function pickDinner() {
  const menus = getMenusByCategory();
  const randomIndex = Math.floor(Math.random() * menus.length);
  const picked = menus[randomIndex];

  // Animate icon
  const icon = document.querySelector('.result-icon');
  icon.classList.add('shake');
  setTimeout(() => icon.classList.remove('shake'), 500);

  // Update icon based on category
  icon.textContent = categoryIcons[picked.category] || 'üçΩÔ∏è';

  // Update result text
  const resultText = document.querySelector('.result-text');
  resultText.textContent = currentLang === 'ko' ? picked.ko : picked.en;
  resultText.classList.add('picked');

  // Add to history
  addToHistory(picked);
}

function addToHistory(menu) {
  dinnerHistory.unshift({
    menu: menu,
    timestamp: new Date()
  });

  // Keep only last 10 items
  if (dinnerHistory.length > 10) {
    dinnerHistory.pop();
  }

  renderHistory();
  saveHistory();
}

function renderHistory() {
  const historyList = document.getElementById('historyList');

  if (dinnerHistory.length === 0) {
    historyList.innerHTML = `<p class="history-empty" data-i18n="historyEmpty">${translations[currentLang].historyEmpty}</p>`;
    return;
  }

  historyList.innerHTML = dinnerHistory.map(item => {
    const menuName = currentLang === 'ko' ? item.menu.ko : item.menu.en;
    const catKey = 'cat' + item.menu.category.charAt(0).toUpperCase() + item.menu.category.slice(1);
    const categoryName = translations[currentLang][catKey];

    return `
      <div class="history-item">
        <span class="menu-name">${categoryIcons[item.menu.category]} ${menuName}</span>
        <span class="menu-category">${categoryName}</span>
      </div>
    `;
  }).join('');
}

function clearHistory() {
  dinnerHistory = [];
  renderHistory();
  saveHistory();

  // Reset result
  const resultText = document.querySelector('.result-text');
  resultText.textContent = translations[currentLang].dinnerPlaceholder;
  resultText.classList.remove('picked');
  document.querySelector('.result-icon').textContent = 'üçΩÔ∏è';
}

function saveHistory() {
  localStorage.setItem('dinnerHistory', JSON.stringify(dinnerHistory));
}

function loadHistory() {
  const saved = localStorage.getItem('dinnerHistory');
  if (saved) {
    dinnerHistory = JSON.parse(saved);
    renderHistory();
  }
}

// ==================== Animal Face Test Functions ====================
const ANIMAL_MODEL_URL = "https://teachablemachine.withgoogle.com/models/n0owLZW-x/";
let animalModel = null;
let uploadedImage = null;

async function loadAnimalModel() {
  if (animalModel) return animalModel;

  try {
    const modelURL = ANIMAL_MODEL_URL + "model.json";
    const metadataURL = ANIMAL_MODEL_URL + "metadata.json";
    animalModel = await tmImage.load(modelURL, metadataURL);
    return animalModel;
  } catch (error) {
    console.error("Failed to load model:", error);
    return null;
  }
}

function handleImageUpload(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    const previewImage = document.getElementById('previewImage');
    const uploadPlaceholder = document.getElementById('uploadPlaceholder');
    const uploadArea = document.getElementById('uploadArea');
    const analyzeBtn = document.getElementById('analyzeBtn');

    previewImage.src = e.target.result;
    previewImage.classList.add('visible');
    uploadPlaceholder.style.display = 'none';
    uploadArea.classList.add('has-image');
    analyzeBtn.disabled = false;

    uploadedImage = previewImage;
  };
  reader.readAsDataURL(file);
}

async function analyzeImage() {
  if (!uploadedImage) return;

  const loadingContainer = document.getElementById('loadingContainer');
  const analyzeBtn = document.getElementById('analyzeBtn');

  // Show loading
  loadingContainer.classList.add('visible');
  analyzeBtn.disabled = true;

  try {
    // Load model if not loaded
    const model = await loadAnimalModel();
    if (!model) {
      alert('Failed to load AI model. Please try again.');
      return;
    }

    // Predict
    const predictions = await model.predict(uploadedImage);

    // Find results
    let dogProb = 0;
    let catProb = 0;

    predictions.forEach(pred => {
      const className = pred.className.toLowerCase();
      if (className.includes('dog') || className.includes('Í∞ïÏïÑÏßÄ')) {
        dogProb = pred.probability;
      } else if (className.includes('cat') || className.includes('Í≥†ÏñëÏù¥')) {
        catProb = pred.probability;
      }
    });

    // Display results
    displayAnimalResult(dogProb, catProb);

  } catch (error) {
    console.error("Analysis failed:", error);
    alert('Analysis failed. Please try again.');
  } finally {
    loadingContainer.classList.remove('visible');
    analyzeBtn.disabled = false;
  }
}

function displayAnimalResult(dogProb, catProb) {
  const resultText = document.getElementById('animalResultText');
  const animalIcon = document.getElementById('animalIcon');
  const probabilityContainer = document.getElementById('animalProbability');
  const iconContainer = document.querySelector('.animal-icon-container');

  const isDog = dogProb > catProb;
  const resultLabel = isDog
    ? translations[currentLang].dogFace
    : translations[currentLang].catFace;

  // Update result text
  resultText.textContent = resultLabel;
  resultText.className = 'animal-result-text ' + (isDog ? 'dog' : 'cat');

  // Update icon
  animalIcon.textContent = isDog ? 'üê∂' : 'üê±';
  iconContainer.style.background = isDog
    ? 'linear-gradient(135deg, #fed7aa, #fdba74)'
    : 'linear-gradient(135deg, #e9d5ff, #d8b4fe)';

  // Update probability bars
  const dogPercent = Math.round(dogProb * 100);
  const catPercent = Math.round(catProb * 100);

  probabilityContainer.innerHTML = `
    <div class="prob-item">
      <span class="prob-label">${translations[currentLang].dogLabel} üê∂</span>
      <div class="prob-bar">
        <div class="prob-fill dog" style="width: ${dogPercent}%"></div>
      </div>
      <span class="prob-value">${dogPercent}%</span>
    </div>
    <div class="prob-item">
      <span class="prob-label">${translations[currentLang].catLabel} üê±</span>
      <div class="prob-bar">
        <div class="prob-fill cat" style="width: ${catPercent}%"></div>
      </div>
      <span class="prob-value">${catPercent}%</span>
    </div>
  `;
}

function resetAnimalTest() {
  const previewImage = document.getElementById('previewImage');
  const uploadPlaceholder = document.getElementById('uploadPlaceholder');
  const uploadArea = document.getElementById('uploadArea');
  const analyzeBtn = document.getElementById('analyzeBtn');
  const resultText = document.getElementById('animalResultText');
  const animalIcon = document.getElementById('animalIcon');
  const probabilityContainer = document.getElementById('animalProbability');
  const iconContainer = document.querySelector('.animal-icon-container');

  previewImage.src = '';
  previewImage.classList.remove('visible');
  uploadPlaceholder.style.display = 'flex';
  uploadArea.classList.remove('has-image');
  analyzeBtn.disabled = true;

  resultText.textContent = translations[currentLang].animalPlaceholder;
  resultText.className = 'animal-result-text';
  animalIcon.textContent = 'ü§î';
  iconContainer.style.background = 'linear-gradient(135deg, #fef3c7, #fde68a)';
  probabilityContainer.innerHTML = '';

  uploadedImage = null;
  document.getElementById('imageInput').value = '';
}

// ==================== Initialize ====================
initTheme();
initLanguage();
loadHistory();
